
/* Finny Chat Styles - Clean & Minimalist Design with Enhanced Keyboard Support */
.finny-chat-card {
  @apply bg-white dark:bg-gray-900 border border-gray-200 dark:border-gray-700 rounded-none sm:rounded-lg shadow-lg overflow-hidden;
}

/* Mobile-first responsive design */
@media (min-width: 640px) {
  .finny-chat-card {
    @apply rounded-lg;
  }
}

.finny-chat-header {
  @apply bg-transparent;
}

/* Messages container with clean background */
.finny-messages-container {
  @apply p-3 sm:p-4;
  background-color: var(--background);
  min-height: 100%;
}

/* Enhanced message bubbles */
.finny-message-user {
  @apply transition-all duration-200;
  animation: slideInRight 0.3s ease-out;
}

.finny-message-bot {
  @apply transition-all duration-200;
  animation: slideInLeft 0.3s ease-out;
}

/* Enhanced input area with keyboard support */
.finny-chat-input-container {
  @apply w-full p-4 bg-background border-t border-gray-100 dark:border-gray-800;
  position: sticky;
  bottom: 0;
  z-index: 50;
  transition: all 0.3s ease;
}

/* Keyboard active state */
.finny-chat-input-container.keyboard-active {
  position: fixed !important;
  bottom: 0 !important;
  left: 0 !important;
  right: 0 !important;
  z-index: 9999 !important;
  background: var(--background) !important;
  border-top: 1px solid var(--border) !important;
  box-shadow: 0 -4px 20px rgba(0, 0, 0, 0.1) !important;
}

/* Input focused state */
.finny-chat-input-container.input-focused {
  background: var(--background) !important;
  box-shadow: 0 -2px 10px rgba(0, 0, 0, 0.05) !important;
}

/* Clean input styles */
.finny-chat-input input {
  @apply text-sm bg-transparent text-gray-900 dark:text-gray-100
    focus:ring-0 focus:border-0 transition-all duration-200
    py-2.5 px-0 placeholder:text-gray-500 dark:placeholder:text-gray-400;
}

/* Clean send button */
.finny-send-button {
  @apply bg-blue-500 hover:bg-blue-600 text-white rounded-lg h-10 w-10 
    shadow-sm hover:shadow-md transition-all duration-200 transform hover:scale-105 active:scale-95 
    disabled:opacity-50 disabled:cursor-not-allowed;
}

/* Enhanced keyboard handling improvements */
.keyboard-aware {
  @apply relative flex flex-col h-full;
  min-height: 100vh;
  min-height: 100dvh;
}

/* Global keyboard open state */
.keyboard-open {
  overflow: hidden !important;
}

.keyboard-open .finny-chat-input-container {
  position: fixed !important;
  bottom: 0 !important;
  left: 0 !important;
  right: 0 !important;
  z-index: 9999 !important;
  background: var(--background) !important;
  border-top: 1px solid var(--border) !important;
  box-shadow: 0 -4px 20px rgba(0, 0, 0, 0.15) !important;
}

/* Clean quick reply buttons */
.quick-reply-button {
  @apply flex items-center gap-1.5 text-sm py-2 px-3 rounded-lg transition-all duration-200
    bg-gray-100 dark:bg-gray-800 hover:bg-gray-200 dark:hover:bg-gray-700 
    text-gray-700 dark:text-gray-300 hover:text-gray-900 dark:hover:text-gray-100 
    disabled:opacity-50 disabled:cursor-not-allowed 
    border border-gray-200 dark:border-gray-700 hover:border-gray-300 dark:hover:border-gray-600 
    shadow-sm hover:shadow-md transform hover:scale-105 active:scale-95 font-medium;
}

/* Clean typing indicator */
.typing-indicator {
  @apply flex items-center gap-3 px-4 py-3 bg-gray-50 dark:bg-gray-800 
    rounded-lg shadow-sm;
}

.typing-dot {
  @apply w-2 h-2 rounded-full bg-gray-400 dark:bg-gray-500;
  animation: typingDot 1.4s infinite ease-in-out;
}

.typing-dot:nth-child(1) { animation-delay: -0.32s; }
.typing-dot:nth-child(2) { animation-delay: -0.16s; }
.typing-dot:nth-child(3) { /* no delay */ }

/* Enhanced scrollbar for desktop */
@media (min-width: 768px) {
  .custom-scrollbar::-webkit-scrollbar {
    width: 6px;
  }
  
  .custom-scrollbar::-webkit-scrollbar-track {
    background: rgba(0, 0, 0, 0.05);
    border-radius: 3px;
  }
  
  .custom-scrollbar::-webkit-scrollbar-thumb {
    background: rgba(0, 0, 0, 0.2);
    border-radius: 3px;
    transition: background 0.2s;
  }
  
  .custom-scrollbar::-webkit-scrollbar-thumb:hover {
    background: rgba(0, 0, 0, 0.3);
  }
}

/* Clean animation keyframes */
@keyframes slideInRight {
  from {
    opacity: 0;
    transform: translateX(20px);
  }
  to {
    opacity: 1;
    transform: translateX(0);
  }
}

@keyframes slideInLeft {
  from {
    opacity: 0;
    transform: translateX(-20px);
  }
  to {
    opacity: 1;
    transform: translateX(0);
  }
}

@keyframes typingDot {
  0%, 80%, 100% {
    transform: scale(0.8);
    opacity: 0.5;
  }
  40% {
    transform: scale(1.2);
    opacity: 1;
  }
}

/* Mobile optimizations with enhanced Android keyboard fixes */
@media (max-width: 640px) {
  .finny-chat-card {
    @apply h-[100dvh] rounded-none border-0 shadow-none;
  }
  
  .finny-message {
    @apply max-w-[85%];
  }
  
  .finny-messages-container {
    @apply px-3 pb-4;
    padding-bottom: 100px; /* Extra space for input area */
  }
  
  .finny-chat-input-container {
    @apply px-4 py-3;
    min-height: 80px;
  }
  
  /* Enhanced keyboard handling for mobile */
  .finny-chat-input-container.keyboard-active {
    position: fixed !important;
    bottom: 0 !important;
    left: 0 !important;
    right: 0 !important;
    z-index: 9999 !important;
    background: var(--background) !important;
    border-top: 1px solid var(--border) !important;
    box-shadow: 0 -4px 20px rgba(0, 0, 0, 0.2) !important;
    padding: 16px !important;
  }
  
  .quick-reply-button {
    @apply text-sm py-2 px-3;
  }
  
  /* Fix text display on mobile */
  .finny-message-content {
    @apply text-sm leading-relaxed;
    word-break: break-word;
    overflow-wrap: break-word;
  }
  
  /* Android status bar fix */
  .safe-area-top {
    padding-top: max(env(safe-area-inset-top, 0px), 24px) !important;
  }
}

/* Focus states for accessibility */
.finny-chat-input input:focus-visible,
.quick-reply-button:focus-visible,
.finny-send-button:focus-visible {
  @apply outline-none ring-2 ring-blue-500/50 ring-offset-2 ring-offset-background;
}

/* Safe area support for modern mobile devices */
.safe-area-bottom {
  padding-bottom: max(16px, env(safe-area-inset-bottom));
}

/* Touch-friendly scrolling */
.touch-scroll-container {
  overflow-y: auto;
  overflow-x: hidden;
  -webkit-overflow-scrolling: touch;
  overscroll-behavior-y: contain;
  scrollbar-width: none;
  -ms-overflow-style: none;
}

.touch-scroll-container::-webkit-scrollbar {
  display: none;
}

/* Enhanced Android-specific mobile chat layout */
@media (max-width: 640px) {
  .finny-chat-mobile-fix {
    height: 100vh;
    height: 100dvh;
    display: flex;
    flex-direction: column;
    overflow: hidden;
    position: relative;
  }
  
  .finny-messages-mobile {
    flex: 1;
    overflow-y: auto;
    overflow-x: hidden;
    -webkit-overflow-scrolling: touch;
    padding-bottom: 100px; /* Space for input */
  }
  
  .finny-input-mobile {
    position: sticky;
    bottom: 0;
    background: var(--background);
    z-index: 50;
    border-top: 1px solid var(--border);
  }
  
  /* Enhanced keyboard open state for all devices */
  .keyboard-open .finny-input-mobile,
  .keyboard-open .finny-chat-input-container {
    position: fixed !important;
    bottom: 0 !important;
    left: 0 !important;
    right: 0 !important;
    z-index: 9999 !important;
    background: var(--background) !important;
    border-top: 1px solid var(--border) !important;
    box-shadow: 0 -4px 20px rgba(0, 0, 0, 0.2) !important;
    transform: translateY(0) !important;
  }
  
  /* Ensure chat container adjusts properly when keyboard opens */
  .keyboard-open .finny-chat-mobile-fix {
    height: 100vh !important;
    height: 100dvh !important;
    overflow: hidden !important;
  }
  
  /* Ensure messages area has proper padding when keyboard is open */
  .keyboard-open .finny-messages-mobile {
    padding-bottom: 120px !important; /* Extra space for keyboard */
  }
}

/* Visual Viewport API support for better keyboard handling */
@supports (height: 100dvh) {
  @media (max-width: 640px) {
    .finny-chat-mobile-fix {
      height: 100dvh;
    }
  }
}

/* Prevent content overflow on mobile */
.mobile-container {
  width: 100%;
  max-width: 100%;
  overflow-x: hidden;
}

/* Body classes for enhanced chat state management */
.finny-chat-open {
  overflow: hidden !important;
  position: fixed !important;
  width: 100% !important;
}

.finny-input-focused .finny-input-mobile,
.finny-input-focused .finny-chat-input-container {
  position: fixed !important;
  bottom: 0 !important;
  left: 0 !important;
  right: 0 !important;
  z-index: 9999 !important;
  background: var(--background) !important;
  border-top: 1px solid var(--border) !important;
  box-shadow: 0 -4px 20px rgba(0, 0, 0, 0.15) !important;
}

/* Enhanced viewport handling */
@media (max-width: 640px) {
  .keyboard-active {
    transform: translateY(0) !important;
    position: fixed !important;
    bottom: 0 !important;
    width: 100% !important;
  }
}
